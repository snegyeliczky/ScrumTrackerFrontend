{"ast":null,"code":"var _jsxFileName = \"/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js\";\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\n\nconst ScrumTable = ({\n  table\n}) => {\n  const [statuses, setStatuses] = useState(table.statuses);\n  const [DragItemColumnId, setDragItemColumnId] = useState();\n  const dragItem = useRef(); //dragged task id and status id where it come from\n\n  const uploadStatusChangeToDatabase = async () => {\n    let refreshItem = {\n      toStatusId: DragItemColumnId,\n      fromStatusId: dragItem.current.statusId,\n      taskId: dragItem.current.taskObject.id\n    };\n    await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n  };\n\n  const onDragEnter = newStatusId => {\n    setDragItemColumnId(newStatusId);\n\n    if (checkTaskInStatus(newStatusId)) {\n      setStatuses(refreshStatus(DragItemColumnId));\n    }\n  };\n\n  const onDragEnd = () => {\n    uploadStatusChangeToDatabase();\n  };\n\n  const checkTaskInStatus = statusId => {\n    for (let status of statuses) {\n      if (status.id === statusId && status.tasks.includes(dragItem.current.taskObject)) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  const refreshStatus = newStatusId => {\n    let newStatuses = [...statuses];\n\n    for (let status of newStatuses) {\n      if (status.id === dragItem.current.statusId) {\n        let taskArr = [];\n\n        for (let task of status.tasks) {\n          if (task === dragItem.current.taskObject) {\n            continue;\n          }\n\n          taskArr.push(task);\n        }\n\n        status.tasks = taskArr;\n      }\n\n      if (newStatusId === status.id) {\n        status.tasks.push(dragItem.current.taskObject);\n      }\n    }\n\n    return newStatuses;\n  }; //\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"scrum_table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, statuses.map(status => {\n    return /*#__PURE__*/React.createElement(Column, {\n      onDragEnd: onDragEnd,\n      dragItem: dragItem,\n      key: status.id,\n      status: status,\n      onDragEnter: onDragEnter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 24\n      }\n    });\n  }));\n};\n\nexport default ScrumTable;","map":{"version":3,"sources":["/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js"],"names":["React","useState","useContext","useEffect","useRef","Column","axios","ScrumTable","table","statuses","setStatuses","DragItemColumnId","setDragItemColumnId","dragItem","uploadStatusChangeToDatabase","refreshItem","toStatusId","fromStatusId","current","statusId","taskId","taskObject","id","put","onDragEnter","newStatusId","checkTaskInStatus","refreshStatus","onDragEnd","status","tasks","includes","newStatuses","taskArr","task","push","map"],"mappings":"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","sourcesContent":["import React, {useState, useContext, useEffect, useRef} from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\n\nconst ScrumTable = ({table}) => {\n\n    const [statuses, setStatuses] = useState(table.statuses);\n    const [DragItemColumnId, setDragItemColumnId] = useState();\n    const dragItem = useRef(); //dragged task id and status id where it come from\n\n    const uploadStatusChangeToDatabase = async () => {\n        let refreshItem = {\n            toStatusId: DragItemColumnId,\n            fromStatusId: dragItem.current.statusId,\n            taskId: dragItem.current.taskObject.id\n        };\n        await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n    };\n\n\n    const onDragEnter = (newStatusId) => {\n        setDragItemColumnId(newStatusId);\n        if (checkTaskInStatus(newStatusId)) {\n            setStatuses(refreshStatus(DragItemColumnId));\n        }\n    };\n\n    const onDragEnd = () => {\n        uploadStatusChangeToDatabase();\n    };\n\n    const checkTaskInStatus = (statusId) => {\n        for (let status of statuses) {\n            if (status.id === statusId && status.tasks.includes(dragItem.current.taskObject)) {\n                return false;\n            }\n        }\n        return true;\n    };\n\n    const refreshStatus = (newStatusId) => {\n        let newStatuses = [...statuses];\n\n        for (let status of newStatuses) {\n            if (status.id === dragItem.current.statusId) {\n                let taskArr = [];\n                for (let task of status.tasks) {\n                    if (task === dragItem.current.taskObject) {\n                        continue;\n                    }\n                    taskArr.push(task);\n                }\n                status.tasks = taskArr\n            }\n            if (newStatusId === status.id) {\n                status.tasks.push(dragItem.current.taskObject)\n            }\n        }\n        return newStatuses;\n    };\n\n    //\n\n    return (\n        <div className={\"scrum_table\"}>\n            {statuses.map(status => {\n                return <Column\n                    onDragEnd={onDragEnd}\n                    dragItem={dragItem}\n                    key={status.id}\n                    status={status}\n                    onDragEnter={onDragEnter}\n                />\n\n            })}\n        </div>\n    );\n};\n\nexport default ScrumTable;"]},"metadata":{},"sourceType":"module"}