{"ast":null,"code":"var _jsxFileName = \"/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js\";\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\n\nconst ScrumTable = ({\n  table\n}) => {\n  const [statuses, setStatuses] = useState(table.statuses);\n  const [DragItemColumnId, setDragItemColumnId] = useState();\n  const dragItem = useRef(); //dragged task id and status id where it come from\n\n  const [loading, setLoading] = useState(false);\n\n  const deleteStatus = async statusID => {\n    await axios.delete(\"http://localhost:8080/project/deletestatus?statusid=\" + statusID + \"&tableid=\" + table.id);\n    setLoading(true);\n    let axiosResponse = await axios.get(\"http://localhost:8080/project/gettable/\" + table.id);\n    setStatuses(axiosResponse.data.statuses);\n  };\n\n  const uploadStatusChangeToDatabase = async () => {\n    let refreshItem = {\n      toStatusId: DragItemColumnId,\n      fromStatusId: dragItem.current.statusId,\n      taskId: dragItem.current.taskObject.id\n    };\n    await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n  };\n\n  const onDragEnter = newStatusId => {\n    setDragItemColumnId(newStatusId);\n  };\n\n  const onDragEnd = () => {\n    setStatuses(refreshStatus(DragItemColumnId));\n    uploadStatusChangeToDatabase();\n  };\n\n  const refreshStatus = newStatusId => {\n    let newStatuses = [...statuses];\n\n    for (let status of newStatuses) {\n      if (status.id === dragItem.current.statusId) {\n        let taskArr = [...status.tasks];\n        let index = taskArr.indexOf(dragItem.current.taskObject);\n\n        if (index > -1) {\n          taskArr.splice(index, 1);\n        }\n\n        status.tasks = taskArr;\n      }\n\n      if (newStatusId === status.id) {\n        status.tasks.push(dragItem.current.taskObject);\n      }\n    }\n\n    return newStatuses;\n  }; //\n\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"scrum_table\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, loading ? /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 27\n    }\n  }, \"Loading...\") : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 22\n    }\n  }, \" \", statuses.map(status => {\n    return /*#__PURE__*/React.createElement(Column, {\n      deleteStatus: deleteStatus,\n      onDragEnd: onDragEnd,\n      dragItem: dragItem,\n      key: status.id,\n      status: status,\n      onDragEnter: onDragEnter,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 36\n      }\n    });\n  })));\n};\n\nexport default ScrumTable;","map":{"version":3,"sources":["/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js"],"names":["React","useState","useContext","useEffect","useRef","Column","axios","ScrumTable","table","statuses","setStatuses","DragItemColumnId","setDragItemColumnId","dragItem","loading","setLoading","deleteStatus","statusID","delete","id","axiosResponse","get","data","uploadStatusChangeToDatabase","refreshItem","toStatusId","fromStatusId","current","statusId","taskId","taskObject","put","onDragEnter","newStatusId","onDragEnd","refreshStatus","newStatuses","status","taskArr","tasks","index","indexOf","splice","push","map"],"mappings":"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","sourcesContent":["import React, {useState, useContext, useEffect, useRef} from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\n\nconst ScrumTable = ({table}) => {\n\n    const [statuses, setStatuses] = useState(table.statuses);\n    const [DragItemColumnId, setDragItemColumnId] = useState();\n    const dragItem = useRef(); //dragged task id and status id where it come from\n    const [loading, setLoading] = useState(false);\n\n\n    const deleteStatus = async (statusID) => {\n        await axios.delete(\"http://localhost:8080/project/deletestatus?statusid=\" + statusID + \"&tableid=\" + table.id);\n        setLoading(true);\n        let axiosResponse = await axios.get(\"http://localhost:8080/project/gettable/\" + table.id);\n        setStatuses(axiosResponse.data.statuses);\n    };\n\n    const uploadStatusChangeToDatabase = async () => {\n        let refreshItem = {\n            toStatusId: DragItemColumnId,\n            fromStatusId: dragItem.current.statusId,\n            taskId: dragItem.current.taskObject.id\n        };\n        await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n    };\n\n\n    const onDragEnter = (newStatusId) => {\n        setDragItemColumnId(newStatusId);\n    };\n\n    const onDragEnd = () => {\n        setStatuses(refreshStatus(DragItemColumnId));\n        uploadStatusChangeToDatabase();\n    };\n\n\n    const refreshStatus = (newStatusId) => {\n        let newStatuses = [...statuses];\n        for (let status of newStatuses) {\n            if (status.id === dragItem.current.statusId) {\n                let taskArr = [...status.tasks];\n                let index = taskArr.indexOf(dragItem.current.taskObject);\n                if (index > -1) {\n                    taskArr.splice(index, 1)\n                }\n                status.tasks = taskArr\n            }\n            if (newStatusId === status.id) {\n                status.tasks.push(dragItem.current.taskObject)\n            }\n        }\n        return newStatuses;\n    };\n\n    //\n\n    return (\n        <div className={\"scrum_table\"}>\n            {\n                loading ? <h2>Loading...</h2>\n                    :<div> {\n                        statuses.map(status => {\n                            return <Column\n                                deleteStatus={deleteStatus}\n                                onDragEnd={onDragEnd}\n                                dragItem={dragItem}\n                                key={status.id}\n                                status={status}\n                                onDragEnter={onDragEnter}\n                            />\n\n                        })\n                    }</div>\n            }\n\n        </div>\n    );\n};\n\nexport default ScrumTable;"]},"metadata":{},"sourceType":"module"}