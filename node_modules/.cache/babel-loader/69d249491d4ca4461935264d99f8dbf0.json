{"ast":null,"code":"var _jsxFileName = \"/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js\";\nimport React, { useState, useContext, useEffect, useRef } from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\nimport { ContentContainer } from \"../styledComps/styled\";\nimport { PlusOutlined } from \"@ant-design/icons\";\n\nconst ScrumTable = ({\n  table,\n  addNewColumn\n}) => {\n  const [statuses, setStatuses] = useState(table.statuses);\n  const [showNewColumn, setShowNewColumn] = useState(false);\n  const newColumnRef = useRef();\n  const [DragItemColumnId, setDragItemColumnId] = useState();\n  const dragItem = useRef(); //dragged task id and status id where it come from\n\n  const deleteStatus = async statusID => {\n    await axios.delete(\"http://localhost:8080/project/deletestatus?statusid=\" + statusID + \"&tableid=\" + table.id);\n    refreshStatusesFromBackend();\n  };\n\n  const refreshStatusesFromBackend = async () => {\n    let axiosResponse = await axios.get(\"http://localhost:8080/project/gettable/\" + table.id);\n    axiosResponse.data.statuses.sort(function (a, b) {\n      return a.position - b.position;\n    });\n    axiosResponse.data.statuses.map(status => {\n      status.tasks.sort(function (a, b) {\n        return a.position - b.position;\n      });\n    });\n    setStatuses(axiosResponse.data.statuses);\n  };\n\n  const uploadStatusChangeToDatabase = async () => {\n    let refreshItem = {\n      toStatusId: DragItemColumnId,\n      fromStatusId: dragItem.current.statusId,\n      taskId: dragItem.current.taskObject.id\n    };\n    await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n  };\n\n  const onDragEnter = newStatusId => {\n    setDragItemColumnId(newStatusId);\n  };\n\n  const onDragEnd = () => {\n    setStatuses(refreshStatus(DragItemColumnId));\n    uploadStatusChangeToDatabase();\n  };\n\n  const refreshStatus = newStatusId => {\n    let newStatuses = [...statuses];\n\n    for (let status of newStatuses) {\n      if (status.id === dragItem.current.statusId) {\n        let taskArr = [...status.tasks];\n        let index = taskArr.indexOf(dragItem.current.taskObject);\n\n        if (index > -1) {\n          taskArr.splice(index, 1);\n        }\n\n        status.tasks = taskArr;\n      }\n\n      if (newStatusId === status.id) {\n        status.tasks.push(dragItem.current.taskObject);\n      }\n    }\n\n    return newStatuses;\n  };\n\n  const handleAddNewColumn = () => {\n    setShowNewColumn(true);\n  };\n\n  const newColumnTextStyle = () => {\n    return showNewColumn ? \"add_new_column_text_active\" : \"add_new_column_text_inactive\";\n  };\n\n  const handleSaveNewColumn = () => {\n    if (newColumnRef.current.value.length < 3) {\n      setShowNewColumn(false);\n      alert(\"add name (minimum 3 character) to your status\");\n      return;\n    }\n\n    addNewColumn(newColumnRef.current.value);\n    setShowNewColumn(false);\n    newColumnRef.current.value = \"\";\n  };\n\n  return /*#__PURE__*/React.createElement(ContentContainer, {\n    className: \"scrum_table\",\n    onDragOver: e => e.preventDefault(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, statuses.map((status, i) => {\n    let statusFlag = null;\n\n    if (i === 0) {\n      statusFlag = \"start\";\n    }\n\n    if (i === statuses.length - 1) {\n      statusFlag = \"finish\";\n    }\n\n    return /*#__PURE__*/React.createElement(Column, {\n      statusFlag: statusFlag,\n      deleteStatus: deleteStatus,\n      onDragEnd: onDragEnd,\n      dragItem: dragItem,\n      key: status.id,\n      status: status,\n      onDragEnter: onDragEnter,\n      refreshStatusesFromBackend: refreshStatusesFromBackend,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 28\n      }\n    });\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    clasName: \"add_new_column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(PlusOutlined, {\n    onClick: handleAddNewColumn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"add_new_column_container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    className: newColumnTextStyle(),\n    ref: newColumnRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"add_new_column_btn\",\n    onClick: handleSaveNewColumn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 21\n    }\n  }, \"add\"))));\n};\n\nexport default ScrumTable;","map":{"version":3,"sources":["/Users/sandornegyeliczky/Desktop/projektek/ScrumTrackerFrontend/frontend/src/components/projectPage/ScrumTable.js"],"names":["React","useState","useContext","useEffect","useRef","Column","axios","ContentContainer","PlusOutlined","ScrumTable","table","addNewColumn","statuses","setStatuses","showNewColumn","setShowNewColumn","newColumnRef","DragItemColumnId","setDragItemColumnId","dragItem","deleteStatus","statusID","delete","id","refreshStatusesFromBackend","axiosResponse","get","data","sort","a","b","position","map","status","tasks","uploadStatusChangeToDatabase","refreshItem","toStatusId","fromStatusId","current","statusId","taskId","taskObject","put","onDragEnter","newStatusId","onDragEnd","refreshStatus","newStatuses","taskArr","index","indexOf","splice","push","handleAddNewColumn","newColumnTextStyle","handleSaveNewColumn","value","length","alert","e","preventDefault","i","statusFlag"],"mappings":"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","sourcesContent":["import React, {useState, useContext, useEffect, useRef} from 'react';\nimport Column from \"./Column\";\nimport axios from \"axios\";\nimport {ContentContainer} from \"../styledComps/styled\"\nimport {PlusOutlined} from \"@ant-design/icons\";\n\nconst ScrumTable = ({table, addNewColumn}) => {\n\n    const [statuses, setStatuses] = useState(table.statuses);\n    const [showNewColumn, setShowNewColumn] = useState(false);\n    const newColumnRef = useRef();\n    const [DragItemColumnId, setDragItemColumnId] = useState();\n    const dragItem = useRef(); //dragged task id and status id where it come from\n\n\n    const deleteStatus = async (statusID) => {\n        await axios.delete(\"http://localhost:8080/project/deletestatus?statusid=\" + statusID + \"&tableid=\" + table.id);\n        refreshStatusesFromBackend();\n    };\n\n    const refreshStatusesFromBackend = async () => {\n        let axiosResponse = await axios.get(\"http://localhost:8080/project/gettable/\" + table.id);\n        axiosResponse.data.statuses.sort(function (a, b) {\n            return a.position - b.position;\n        });\n        axiosResponse.data.statuses.map(status =>{\n            status.tasks.sort(function (a,b) {\n                return a.position - b.position;\n            })\n        });\n\n        setStatuses(axiosResponse.data.statuses);\n    };\n\n    const uploadStatusChangeToDatabase = async () => {\n        let refreshItem = {\n            toStatusId: DragItemColumnId,\n            fromStatusId: dragItem.current.statusId,\n            taskId: dragItem.current.taskObject.id\n        };\n        await axios.put(\"http://localhost:8080/task/transfer\", refreshItem);\n    };\n\n\n    const onDragEnter = (newStatusId) => {\n        setDragItemColumnId(newStatusId);\n    };\n\n    const onDragEnd = () => {\n        setStatuses(refreshStatus(DragItemColumnId));\n        uploadStatusChangeToDatabase();\n    };\n\n\n    const refreshStatus = (newStatusId) => {\n        let newStatuses = [...statuses];\n        for (let status of newStatuses) {\n            if (status.id === dragItem.current.statusId) {\n                let taskArr = [...status.tasks];\n                let index = taskArr.indexOf(dragItem.current.taskObject);\n                if (index > -1) {\n                    taskArr.splice(index, 1)\n                }\n                status.tasks = taskArr\n            }\n            if (newStatusId === status.id) {\n                status.tasks.push(dragItem.current.taskObject)\n            }\n        }\n        return newStatuses;\n    };\n\n    const handleAddNewColumn = () => {\n        setShowNewColumn(true);\n    };\n\n    const newColumnTextStyle = () => {\n        return showNewColumn ? \"add_new_column_text_active\" : \"add_new_column_text_inactive\";\n    };\n\n    const handleSaveNewColumn = () => {\n        if (newColumnRef.current.value.length < 3) {\n            setShowNewColumn(false);\n            alert(\"add name (minimum 3 character) to your status\");\n            return;\n        }\n        addNewColumn(newColumnRef.current.value);\n        setShowNewColumn(false);\n        newColumnRef.current.value = \"\";\n\n    };\n\n    return (\n        <ContentContainer className={\"scrum_table\"}\n                          onDragOver={(e) => e.preventDefault()}>\n            {\n                statuses.map((status, i) => {\n                    let statusFlag = null;\n\n                    if (i === 0) {\n                        statusFlag = \"start\";\n                    }\n                    if (i === statuses.length - 1) {\n                        statusFlag = \"finish\";\n                    }\n\n                    return <Column\n                        statusFlag={statusFlag}\n                        deleteStatus={deleteStatus}\n                        onDragEnd={onDragEnd}\n                        dragItem={dragItem}\n                        key={status.id}\n                        status={status}\n                        onDragEnter={onDragEnter}\n                        refreshStatusesFromBackend={refreshStatusesFromBackend}\n                    />\n\n                })\n            }\n            <div clasName=\"add_new_column\">\n                <PlusOutlined onClick={handleAddNewColumn}/>\n                <div className=\"add_new_column_container\">\n                    <input className={newColumnTextStyle()}\n                           ref={newColumnRef}/>\n                    <div className=\"add_new_column_btn\"\n                         onClick={handleSaveNewColumn}>add</div>\n                </div>\n            </div>\n        </ContentContainer>\n    );\n};\n\nexport default ScrumTable;"]},"metadata":{},"sourceType":"module"}